<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NUTRIVIE</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
            background-image: url('https://images.unsplash.com/photo-1496412705862-e0088f16f791?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            background-attachment: fixed;
            color: #333;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        p.intro {
            text-align: center;
            margin-bottom: 30px;
            padding: 15px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
        }

        .container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .panel {
            flex: 1;
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.9);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .panel:hover {
            transform: translateY(-5px);
        }

        h2 {
            color: #2c3e50;
            margin-top: 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }

        button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #c0392b;
        }

        #result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.9);
            min-height: 100px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .fact {
            margin-bottom: 8px;
            padding: 10px;
            background-color: #e8f4f8;
            border-left: 4px solid #3498db;
            border-radius: 4px;
            display: flex;
            align-items: center;
        }

        .fact:before {
            content: "üç¥";
            margin-right: 10px;
            font-size: 1.2em;
        }

        .rule {
            margin-bottom: 8px;
            padding: 10px;
            background-color: #f1f8e9;
            border-left: 4px solid #7cb342;
            border-radius: 4px;
        }

        .rule strong {
            color: #558b2f;
        }

        .conclusion {
            font-weight: bold;
            color: #e74c3c;
            padding: 8px;
            background-color: #fdedec;
            border-radius: 4px;
            margin: 5px 0;
            display: inline-block;
        }

        #factSelect {
            width: 100%;
            height: 150px;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
            margin-bottom: 10px;
            background-color: white;
        }

        .inference-step {
            padding: 8px;
            margin-bottom: 5px;
            background-color: #f5f5f5;
            border-radius: 4px;
        }

        .category-box {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            text-align: center;
        }

        .breakfast { background-color: #f39c12; }
        .lunch { background-color: #3498db; }
        .dinner { background-color: #9b59b6; }
        .snack { background-color: #1abc9c; }
        .health-food { background-color: #2ecc71; }
    </style>
</head>
<body>
    <h1>üçΩÔ∏è NUTRIVIE</h1>
    <div class="container">
        <div class="panel">
            <h2>Working Memory</h2>
            <div id="workingMemory"></div>
            <button onclick="resetSystem()">Reset System</button>
        </div>
        
        <div class="panel">
            <h2>Add New Facts</h2>
            <select id="factSelect" multiple>
                <option value="served in morning">üç≥ Served in morning</option>
                <option value="light meal">ü•ê Light meal</option>
                <option value="toast">üçû Toast</option>
                <option value="cereal">ü•£ Cereal</option>
                <option value="porridge">üç≤ Porridge</option>
                <option value="pancake">ü•û Pancake</option>
                <option value="smoothie">üçπ Smoothie</option>
                <option value="served at noon">üç± Served at noon</option>
                <option value="high calorie">üçî High calorie</option>
                <option value="fried rice">üçõ Fried rice</option>
                <option value="burger">üçî Burger</option>
                <option value="fried chicken">üçó Fried chicken</option>
                <option value="noodle soup">üçú Noodle soup</option>
                <option value="bento">üç± Bento</option>
                <option value="served at night">üçΩÔ∏è Served at night</option>
                <option value="heavy meal">üçñ Heavy meal</option>
                <option value="steak">ü•© Steak</option>
                <option value="nasi goreng">üçõ Nasi goreng</option>
                <option value="pasta carbonara">üçù Pasta carbonara</option>
                <option value="chicken soup">üç≤ Chicken soup</option>
                <option value="sushi">üç£ Sushi</option>
                <option value="quick prep">‚è±Ô∏è Quick preparation</option>
                <option value="light snack">üç™ Light snack</option>
                <option value="chips">ü•î Chips</option>
                <option value="donut">üç© Donut</option>
                <option value="filled bread">ü•ñ Filled bread</option>
                <option value="yogurt cup">ü•õ Yogurt cup</option>
                <option value="popcorn">üçø Popcorn</option>
                <option value="nutritious">ü•¶ Nutritious</option>
                <option value="balanced diet">ü•ó Balanced diet</option>
                <option value="salad">ü•¨ Salad</option>
                <option value="granola bar">üç´ Granola bar</option>
                <option value="smoothie bowl">ü•£ Smoothie bowl</option>
                <option value="oatmeal">ü•£ Oatmeal</option>
                <option value="avocado toast">ü•ë Avocado toast</option>
            </select>
            <button onclick="addFacts()">Add Selected Facts</button>
        </div>
    </div>
    
    <div class="panel">
        <h2>Rules</h2>
        <div id="rulesList"></div>
    </div>
    
    <div id="result"></div>
    
    <script>
        const rules = [
            { id: 'R1', condition: ['served in morning'], conclusion: 'is Breakfast' },
            { id: 'R2', condition: ['light meal'], conclusion: 'is Breakfast' },
            { id: 'R3', condition: ['toast', 'cereal', 'porridge', 'pancake', 'smoothie'], conclusion: 'category Breakfast' },
            { id: 'R4', condition: ['served at noon'], conclusion: 'is Lunch' },
            { id: 'R5', condition: ['high calorie'], conclusion: 'is Lunch' },
            { id: 'R6', condition: ['fried rice', 'burger', 'fried chicken', 'noodle soup', 'bento'], conclusion: 'category Lunch' },
            { id: 'R7', condition: ['served at night'], conclusion: 'is Dinner' },
            { id: 'R8', condition: ['heavy meal'], conclusion: 'is Dinner' },
            { id: 'R9', condition: ['steak', 'nasi goreng', 'pasta carbonara', 'chicken soup', 'sushi'], conclusion: 'category Dinner' },
            { id: 'R10', condition: ['quick prep'], conclusion: 'is Snack' },
            { id: 'R11', condition: ['light snack'], conclusion: 'is Snack' },
            { id: 'R12', condition: ['chips', 'donut', 'filled bread', 'yogurt cup', 'popcorn'], conclusion: 'category Snack' },
            { id: 'R13', condition: ['nutritious'], conclusion: 'is Health Food' },
            { id: 'R14', condition: ['balanced diet'], conclusion: 'is Health Food' },
            { id: 'R15', condition: ['salad', 'granola bar', 'smoothie bowl', 'oatmeal', 'avocado toast'], conclusion: 'category Health Food' }
        ];

        let workingMemory = [];
        let conclusions = [];

        function initializeDisplay() {
            displayWorkingMemory();
            displayRules();
        }

        function displayWorkingMemory() {
            const wmElement = document.getElementById('workingMemory');
            wmElement.innerHTML = '<h3>Current Facts:</h3>';
            if (workingMemory.length === 0) {
                wmElement.innerHTML += '<p>No facts added yet.</p>';
            } else {
                workingMemory.forEach(fact => {
                    const emoji = document.querySelector(`option[value="${fact}"]`).textContent.split(' ')[0];
                    wmElement.innerHTML += `<div class="fact">${emoji} ${fact}</div>`;
                });
            }
        }

        function displayRules() {
            const rulesElement = document.getElementById('rulesList');
            rulesElement.innerHTML = '';
            rules.forEach(rule => {
                let ruleHtml = `<div class="rule"><strong>${rule.id}:</strong> IF `;
                const conditionsWithEmoji = rule.condition.map(cond => {
                    const option = document.querySelector(`option[value="${cond}"]`);
                    return option ? option.textContent.split(' ')[0] + ' ' + cond : cond;
                }).join(' OR ');
                ruleHtml += conditionsWithEmoji;
                ruleHtml += ` THEN ${rule.conclusion}</div>`;
                rulesElement.innerHTML += ruleHtml;
            });
        }

        function addFacts() {
            const factSelect = document.getElementById('factSelect');
            const selectedFacts = Array.from(factSelect.selectedOptions).map(option => option.value);
            let addedFacts = [];
            let duplicateFacts = [];

            selectedFacts.forEach(fact => {
                if (!workingMemory.includes(fact)) {
                    workingMemory.push(fact);
                    addedFacts.push(fact);
                } else {
                    duplicateFacts.push(fact);
                }
            });

            displayWorkingMemory();
            const resultElement = document.getElementById('result');

            if (addedFacts.length > 0) {
                resultElement.innerHTML = '<p class="inference-step">Added facts: ' + 
                    addedFacts.map(fact => {
                        const emoji = document.querySelector(`option[value="${fact}"]`).textContent.split(' ')[0];
                        return `${emoji} ${fact}`;
                    }).join(', ') + '</p>';
                forwardChain();
            } else {
                resultElement.innerHTML = '<p class="inference-step">No new facts added. Selected facts already exist: ' + 
                    duplicateFacts.map(fact => {
                        const emoji = document.querySelector(`option[value="${fact}"]`).textContent.split(' ')[0];
                        return `${emoji} ${fact}`;
                    }).join(', ') + '</p>';
            }
        }

        function forwardChain() {
            let newConclusions = [];
            let somethingChanged = true;
            let iterations = 0;
            const maxIterations = 100;
            const resultElement = document.getElementById('result');
            resultElement.innerHTML = '<h3>Inference Process:</h3>';

            while (somethingChanged && iterations < maxIterations) {
                somethingChanged = false;
                iterations++;
                rules.forEach(rule => {
                    const conditionsMet = rule.condition.some(cond => 
                        workingMemory.includes(cond) || conclusions.includes(cond)
                    );
                    const conclusionNotReached = !conclusions.includes(rule.conclusion) && 
                                                !workingMemory.includes(rule.conclusion);
                    if (conditionsMet && conclusionNotReached) {
                        conclusions.push(rule.conclusion);
                        newConclusions.push(rule.conclusion);
                        somethingChanged = true;
                        resultElement.innerHTML += 
                            `<div class="inference-step">Applied ${rule.id}: Added <span class="conclusion">${rule.conclusion}</span></div>`;
                    }
                });
            }

            if (newConclusions.length > 0) {
                resultElement.innerHTML += '<h3>Conclusions:</h3>';
                newConclusions.forEach(conc => {
                    resultElement.innerHTML += `<div class="conclusion">${conc}</div>`;
                });
            } else if (conclusions.length === 0) {
                resultElement.innerHTML += '<p>No conclusions derived. Try adding facts that match rule conditions.</p>';
            } else {
                resultElement.innerHTML += '<p>All possible conclusions derived for current facts.</p>';
            }

            const foodCategories = conclusions.filter(conc => 
                conc.includes('Breakfast') || 
                conc.includes('Lunch') || 
                conc.includes('Dinner') || 
                conc.includes('Snack') || 
                conc.includes('Health Food')
            );

            if (foodCategories.length > 0) {
                resultElement.innerHTML += '<h3>Food Categories:</h3>';
                foodCategories.forEach(cat => {
                    let categoryClass = '';
                    if (cat.includes('Breakfast')) categoryClass = 'breakfast';
                    if (cat.includes('Lunch')) categoryClass = 'lunch';
                    if (cat.includes('Dinner')) categoryClass = 'dinner';
                    if (cat.includes('Snack')) categoryClass = 'snack';
                    if (cat.includes('Health Food')) categoryClass = 'health-food';
                    resultElement.innerHTML += `<div class="category-box ${categoryClass}">${cat}</div>`;
                });
            }
        }

        function resetSystem() {
            workingMemory = [];
            conclusions = [];
            displayWorkingMemory();
            document.getElementById('result').innerHTML = '<p>System reset. Add new facts to start.</p>';
        }

        window.onload = initializeDisplay;
    </script>
</body>
</html>